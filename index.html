<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>í”„ë¦¬ë¯¸ì—„ ê²Œì„ ì„¼í„°</title>
  <style>
    :root { 
      --bg:#070a0f; --card:rgba(17, 24, 38, 0.95); --text:#e6eef9; --accent:#6ee7ff; --line:#2b3b55;
    }
    body { 
      margin:0; font-family: sans-serif; background: var(--bg); color: var(--text);
      overflow-x: hidden;
    }

    /* ë°°ê²½ ì´ë¯¸ì§€ê°€ ë“¤ì–´ê°€ëŠ” ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .img-btn {
      background-size: cover; background-position: center; border: 1px solid var(--accent);
      color: white; cursor: pointer; font-weight: bold; transition: 0.3s;
      text-shadow: 1px 1px 2px black; position: relative; overflow: hidden;
    }
    .img-btn:hover { transform: scale(1.05); filter: brightness(1.2); }

    /* ë©”ì¸ í˜ì´ì§€ */
    #mainPage {
      height: 100vh; width: 100%;
      background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.8)), 
                  url('https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&w=1600&q=80');
      background-size: cover; background-position: center;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
    }
    .main-selector { display: flex; gap: 30px; }
    .menu-card {
      width: 250px; height: 350px; background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px); border: 2px solid var(--accent); border-radius: 20px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; transition: 0.3s;
    }

    /* ê²Œì„ ì»¨í…Œì´ë„ˆ */
    #gamePage { display: none; padding: 20px; min-height: 100vh; text-align: center; }
    
    /* ëŒì•„ê°€ê¸° ë²„íŠ¼ ì´ë¯¸ì§€ ì„¤ì • ê°€ëŠ¥ */
    .back-btn { 
        position: absolute; top: 20px; left: 20px; width: 120px; height: 45px; border-radius: 5px;
        background-image: url(''); /* ëŒì•„ê°€ê¸° ë²„íŠ¼ ì´ë¯¸ì§€ ì£¼ì†Œ */
    }

    /* ì‚¬ë‹¤ë¦¬ ë ˆì´ì•„ì›ƒ */
    .ladder-container { max-width: 1000px; margin: 0 auto; }
    .preset-btns { display: flex; gap: 10px; justify-content: center; margin: 30px 0; }
    
    /* í”„ë¦¬ì…‹ ë²„íŠ¼ë³„ ì´ë¯¸ì§€ ì„¤ì • (CSSì—ì„œ ì£¼ì†Œ ì…ë ¥) */
    .btn-835 { background-image: url(''); width: 140px; height: 50px; border-radius: 25px; }
    .btn-1435 { background-image: url(''); width: 140px; height: 50px; border-radius: 25px; }
    .btn-3535 { background-image: url(''); width: 140px; height: 50px; border-radius: 25px; }
    .btn-18335 { background-image: url(''); width: 140px; height: 50px; border-radius: 25px; }

    .ladder-frame { position: relative; margin: 40px auto; display: inline-block; }
    
    /* í•­ëª©ì¹¸ ì •ë ¬: ìº”ë²„ìŠ¤ ë„ˆë¹„ì™€ ì •í™•íˆ ì¼ì¹˜í•˜ë„ë¡ ì„¤ì • */
    .label-grid { 
        display: flex; justify-content: space-around; 
        width: 800px; /* ìº”ë²„ìŠ¤ ë„ˆë¹„ì™€ ë™ì¼ */
        margin: 0 auto;
    }
    .label-grid .input-wrap { flex: 1; display: flex; justify-content: center; }
    .label-grid input { 
      width: 60px; background: #0c1422; color: white; border: 1px solid var(--line);
      padding: 8px 0; border-radius: 8px; text-align: center; font-size: 14px;
    }

    canvas { background: transparent; display: block; z-index: 1; position: relative; }

    /* ë§ ì„¤ì • */
    #playerPiece {
      position: absolute; width: 28px; height: 28px;
      background-image: url('https://cdn-icons-png.flaticon.com/128/802/802340.png');
      background-size: contain; background-repeat: no-repeat;
      display: none; z-index: 10; pointer-events: none;
      transform: translate(-50%, -100%);
    }

    /* ìƒì„± ë²„íŠ¼ ì´ë¯¸ì§€ */
    .gen-btn {
        width: 250px; height: 60px; font-size: 20px; border-radius: 10px; margin-top: 30px;
        background-image: url(''); /* ì‚¬ë‹¤ë¦¬ ìƒì„± ë²„íŠ¼ ì´ë¯¸ì§€ */
    }

    /* ì£¼ì‚¬ìœ„ ìŠ¤íƒ€ì¼ */
    .dice-wrap { display: flex; flex-direction: column; align-items: center; padding-top: 50px; }
    .dice-row { display: flex; gap: 20px; margin-bottom: 20px; }
    .dice { width: 100px; height: 100px; background: white; border-radius: 15px; color: black; font-size: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .roll-btn { width: 200px; height: 60px; border-radius: 10px; background-image: url(''); }
  </style>
</head>
<body>

  <div id="mainPage">
    <h1>GAME CENTER</h1>
    <div class="main-selector">
      <div class="menu-card" onclick="showGame('ladder')"><i>ğŸªœ</i><h2>ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</h2></div>
      <div class="menu-card" onclick="showGame('dice')"><i>ğŸ²</i><h2>ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</h2></div>
    </div>
  </div>

  <div id="gamePage">
    <button class="back-btn img-btn" onclick="goHome()">BACK</button>
    
    <div id="ladderGame" class="ladder-container" style="display:none;">
      <div class="preset-btns">
        <button class="img-btn btn-835" onclick="applyPreset('835', 5)">ğŸ˜ˆ 835 ğŸ˜ˆ</button>
        <button class="img-btn btn-1435" onclick="applyPreset('1435', 5)">ğŸ‘¼ 1435 ğŸ‘¼</button>
        <button class="img-btn btn-3535" onclick="applyPreset('3535', 4)">ğŸ‘ 3535 ğŸ‘</button>
        <button class="img-btn btn-18335" onclick="applyPreset('18335', 3)">â¤ï¸ 18335 â¤ï¸</button>
      </div>

      <div class="ladder-frame">
        <div id="topInputs" class="label-grid"></div>
        <div style="position: relative;">
          <div id="playerPiece"></div>
          <canvas id="ladderCanvas" width="800" height="500"></canvas>
        </div>
        <div id="bottomInputs" class="label-grid"></div>
      </div>
      <br>
      <button class="img-btn gen-btn" onclick="generateLadder()">ì‚¬ë‹¤ë¦¬ ìƒì„±</button>
    </div>

    <div id="diceGame" class="dice-wrap" style="display:none;">
      <h2>ìŒì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</h2>
      <div class="dice-row">
        <div id="d1" class="dice">?</div>
        <div id="d2" class="dice">?</div>
      </div>
      <button class="img-btn roll-btn" onclick="rollDices()">ROLL!</button>
    </div>
  </div>

<script>
  const canvas = document.getElementById('ladderCanvas');
  const ctx = canvas.getContext('2d');
  const piece = document.getElementById('playerPiece');
  let state = { n: 5, h: 15, links: [], isMoving: false };

  function showGame(type) {
    document.getElementById('mainPage').style.display = 'none';
    document.getElementById('gamePage').style.display = 'block';
    document.getElementById('ladderGame').style.display = type === 'ladder' ? 'block' : 'none';
    document.getElementById('diceGame').style.display = type === 'dice' ? 'block' : 'none';
    if(type === 'ladder') applyPreset('835', 5);
  }

  function goHome() {
    document.getElementById('mainPage').style.display = 'flex';
    document.getElementById('gamePage').style.display = 'none';
  }

  // ì¢Œí‘œ ê³„ì‚° í•¨ìˆ˜: í•­ëª©ì˜ ì¤‘ì•™ê³¼ ìº”ë²„ìŠ¤ ì„ ì„ ì¼ì¹˜ì‹œí‚´
  function getXPos(idx) {
    const colWidth = canvas.width / state.n;
    return (idx * colWidth) + (colWidth / 2);
  }

  function applyPreset(name, count) {
    state.n = count;
    const topWrap = document.getElementById('topInputs');
    const botWrap = document.getElementById('bottomInputs');
    
    topWrap.innerHTML = ''; botWrap.innerHTML = '';
    for(let i=0; i<count; i++) {
      topWrap.innerHTML += `<div class="input-wrap"><input type="text" value="${i+1}" id="t${i}" onclick="startFrom(${i})"></div>`;
      botWrap.innerHTML += `<div class="input-wrap"><input type="text" value="?" id="b${i}"></div>`;
    }
    ctx.clearRect(0,0,canvas.width, canvas.height);
    state.links = [];
    drawStaticLines();
  }

  function drawStaticLines() {
    const h = canvas.height;
    ctx.strokeStyle = "#2b3b55"; ctx.lineWidth = 3;
    for(let i=0; i<state.n; i++) {
      const x = getXPos(i);
      ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, h); ctx.stroke();
    }
  }

  function generateLadder() {
    if(state.isMoving) return;
    state.links = Array.from({length: state.h}, () => []);
    for(let y=0; y<state.h; y++) {
      for(let x=0; x<state.n-1; x++) {
        if(Math.random() < 0.5) { state.links[y].push(x); x++; }
      }
    }
    renderAll();
  }

  function renderAll() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    drawStaticLines();
    const dy = canvas.height / (state.h + 1);
    ctx.strokeStyle = "#6ee7ff"; ctx.lineWidth = 4;
    state.links.forEach((row, y) => {
      const yy = (y + 1) * dy;
      row.forEach(x => {
        ctx.beginPath(); 
        ctx.moveTo(getXPos(x), yy); 
        ctx.lineTo(getXPos(x+1), yy); 
        ctx.stroke();
      });
    });
  }

  async function startFrom(colIdx) {
    if(state.links.length === 0 || state.isMoving) return;
    state.isMoving = true;
    const dy = canvas.height / (state.h + 1);
    let curCol = colIdx;
    let curX = getXPos(curCol), curY = 0;

    piece.style.display = 'block';
    updatePiecePos(curX, curY);

    for(let y=0; y<state.h; y++) {
      const targetY = (y + 1) * dy;
      await animatePiece(curX, targetY); curY = targetY;
      let nextX = curX;
      if(state.links[y].includes(curCol)) { curCol++; nextX = getXPos(curCol); }
      else if(state.links[y].includes(curCol - 1)) { curCol--; nextX = getXPos(curCol); }
      if(nextX !== curX) { await animatePiece(nextX, curY); curX = nextX; }
    }
    await animatePiece(curX, canvas.height);
    state.isMoving = false;
  }

  function updatePiecePos(x, y) {
    piece.style.left = x + 'px';
    piece.style.top = y + 'px';
  }

  function animatePiece(tx, ty) {
    return new Promise(resolve => {
      const sx = parseFloat(piece.style.left), sy = parseFloat(piece.style.top);
      const startTime = performance.now();
      function step(now) {
        const p = Math.min((now - startTime) / 150, 1);
        updatePiecePos(sx + (tx - sx) * p, sy + (ty - sy) * p);
        if(p < 1) requestAnimationFrame(step); else resolve();
      }
      requestAnimationFrame(step);
    });
  }

  function rollDices() {
    document.getElementById('d1').innerText = Math.floor(Math.random()*6)+1;
    document.getElementById('d2').innerText = Math.floor(Math.random()*6)+1;
  }
</script>
</body>
</html>
