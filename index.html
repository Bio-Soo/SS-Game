<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>í”„ë¦¬ë¯¸ì—„ ê²Œì„ ì„¼í„°</title>
  <style>
    :root { 
      --bg:#070a0f; --card:rgba(17, 24, 38, 0.95); --text:#e6eef9; --accent:#6ee7ff; --line:#2b3b55;
    }
    body { 
      margin:0; font-family: sans-serif; background: var(--bg); color: var(--text);
      overflow-x: hidden;
    }

    /* 1. ë©”ì¸ ëŒ€í˜• ì´ë¯¸ì§€ í˜ì´ì§€ */
    #mainPage {
      height: 100vh; width: 100%;
      background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.8)), 
                  url('https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&w=1600&q=80'); /* ë©”ì¸ í° ì‚¬ì§„ */
      background-size: cover; background-position: center;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
    }
    #mainPage h1 { font-size: 3.5rem; margin-bottom: 40px; text-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    .main-selector { display: flex; gap: 30px; }
    .menu-card {
      width: 250px; height: 350px; background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px); border: 2px solid var(--accent); border-radius: 20px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; transition: 0.3s;
    }
    .menu-card:hover { transform: translateY(-10px); background: rgba(110, 231, 255, 0.2); }
    .menu-card i { font-size: 80px; margin-bottom: 20px; }
    .menu-card h2 { margin: 0; }

    /* ê²Œì„ ì»¨í…Œì´ë„ˆ */
    #gamePage { display: none; padding: 20px; min-height: 100vh; }
    .back-btn { position: absolute; top: 20px; left: 20px; padding: 10px 20px; background: none; border: 1px solid var(--accent); color: var(--accent); cursor: pointer; border-radius: 5px; }

    /* 2. ì‚¬ë‹¤ë¦¬ ë ˆì´ì•„ì›ƒ ì¡°ì • */
    .ladder-container { max-width: 1000px; margin: 0 auto; text-align: center; }
    .preset-btns { display: flex; gap: 10px; justify-content: center; margin: 30px 0; }
    .preset-btns button { 
      padding: 12px 20px; background: #1e293b; border: 1px solid var(--accent); 
      color: white; border-radius: 50px; cursor: pointer; font-weight: bold; font-size: 14px;
    }

    .ladder-frame { position: relative; margin-top: 40px; }
    canvas { background: transparent; display: block; margin: 0 auto; cursor: pointer; z-index: 1; position: relative; }

    /* í•­ëª©ì¹¸(Input) ë””ìì¸: í­ ì¤„ì´ê³  ì¤‘ê°„ ì •ë ¬ */
    .label-grid { display: flex; justify-content: center; gap: 0; margin: 5px 0; }
    .label-grid input { 
      width: 70px; /* í­ì„ ì¤„ì„ */
      background: #0c1422; color: white; border: 1px solid var(--line);
      padding: 8px 0; border-radius: 8px; text-align: center; font-size: 14px;
      margin: 0 auto; /* ì¤‘ì•™ ì •ë ¬ìš© */
    }

    /* 3. ë§ ì„¤ì •: í¬ê¸° 2/3 (ì•½ 26px), ì‚¬ë‹¤ë¦¬ ìœ„ë¡œ(z-index) */
    #playerPiece {
      position: absolute; width: 28px; height: 28px; /* ì›ë˜ 40pxì˜ ì•½ 2/3 */
      background-image: url('https://cdn-icons-png.flaticon.com/128/802/802340.png');
      background-size: contain; background-repeat: no-repeat;
      display: none; z-index: 10; pointer-events: none;
      transform: translate(-50%, -100%); /* ë°œ ëì´ ì„ ì— ë‹¿ê²Œ */
    }

    /* ì£¼ì‚¬ìœ„ ìŠ¤íƒ€ì¼ */
    .dice-wrap { display: flex; flex-direction: column; align-items: center; padding-top: 50px; }
    .dice-row { display: flex; gap: 20px; margin-bottom: 20px; }
    .dice { width: 100px; height: 100px; background: white; border-radius: 15px; color: black; font-size: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
  </style>
</head>
<body>

  <div id="mainPage">
    <h1>GAME CENTER</h1>
    <div class="main-selector">
      <div class="menu-card" onclick="showGame('ladder')">
        <i>ğŸªœ</i>
        <h2>ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</h2>
      </div>
      <div class="menu-card" onclick="showGame('dice')">
        <i>ğŸ²</i>
        <h2>ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</h2>
      </div>
    </div>
  </div>

  <div id="gamePage">
    <button class="back-btn" onclick="goHome()">â† ëŒì•„ê°€ê¸°</button>
    
    <div id="ladderGame" class="ladder-container" style="display:none;">
      <div class="preset-btns">
        <button onclick="applyPreset('835', 5)">ğŸ˜ˆ 835 ğŸ˜ˆ</button>
        <button onclick="applyPreset('1435', 5)">ğŸ‘¼ 1435 ğŸ˜ˆ</button>
        <button onclick="applyPreset('3535', 4)">ğŸ‘ 3535 ğŸ‘</button>
        <button onclick="applyPreset('18335', 3)">â¤ï¸ 18335 â¤ï¸</button>
      </div>

      <div class="ladder-frame">
        <div id="topInputs" class="label-grid"></div>
        <div style="position: relative;">
          <div id="playerPiece"></div>
          <canvas id="ladderCanvas" width="800" height="500"></canvas>
        </div>
        <div id="bottomInputs" class="label-grid"></div>
      </div>
      <button onclick="generateLadder()" style="margin-top:30px; padding:15px 50px; font-size:20px; cursor:pointer; background:var(--accent); border:none; border-radius:10px; font-weight:bold;">ì‚¬ë‹¤ë¦¬ ìƒì„±</button>
    </div>

    <div id="diceGame" class="dice-wrap" style="display:none;">
      <h2>ìŒì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</h2>
      <div class="dice-row">
        <div id="d1" class="dice">?</div>
        <div id="d2" class="dice">?</div>
      </div>
      <button onclick="rollDices()" style="padding:15px 40px; cursor:pointer;">êµ´ë¦¬ê¸°!</button>
    </div>
  </div>

<script>
  const canvas = document.getElementById('ladderCanvas');
  const ctx = canvas.getContext('2d');
  const piece = document.getElementById('playerPiece');

  let state = { n: 5, h: 15, links: [], isMoving: false };

  // í™”ë©´ ì „í™˜ ë¡œì§
  function showGame(type) {
    document.getElementById('mainPage').style.display = 'none';
    document.getElementById('gamePage').style.display = 'block';
    document.getElementById('ladderGame').style.display = type === 'ladder' ? 'block' : 'none';
    document.getElementById('diceGame').style.display = type === 'dice' ? 'block' : 'none';
    if(type === 'ladder') applyPreset('835', 5);
  }

  function goHome() {
    document.getElementById('mainPage').style.display = 'flex';
    document.getElementById('gamePage').style.display = 'none';
  }

  // ì‚¬ë‹¤ë¦¬ í”„ë¦¬ì…‹ ì ìš©
  function applyPreset(name, count) {
    state.n = count;
    const topWrap = document.getElementById('topInputs');
    const botWrap = document.getElementById('bottomInputs');
    
    topWrap.innerHTML = ''; botWrap.innerHTML = '';
    for(let i=0; i<count; i++) {
      // ìœ„ìª½ í•­ëª© ë””í´íŠ¸ëŠ” ìˆ«ì 1, 2, 3...
      topWrap.innerHTML += `<div style="flex:1"><input type="text" value="${i+1}" id="t${i}" onclick="startFrom(${i})"></div>`;
      botWrap.innerHTML += `<div style="flex:1"><input type="text" value="?" id="b${i}"></div>`;
    }
    ctx.clearRect(0,0,canvas.width, canvas.height);
    state.links = [];
    drawStaticLines();
  }

  function drawStaticLines() {
    const w = canvas.width, h = canvas.height;
    const dx = w / (state.n + 1);
    ctx.strokeStyle = "#2b3b55"; ctx.lineWidth = 3;
    for(let i=1; i<=state.n; i++) {
      ctx.beginPath(); ctx.moveTo(i*dx, 0); ctx.lineTo(i*dx, h); ctx.stroke();
    }
  }

  function generateLadder() {
    if(state.isMoving) return;
    state.links = Array.from({length: state.h}, () => []);
    for(let y=0; y<state.h; y++) {
      for(let x=1; x<state.n; x++) {
        if(Math.random() < 0.5) { state.links[y].push(x); x++; }
      }
    }
    renderAll();
  }

  function renderAll() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    drawStaticLines();
    const dx = canvas.width / (state.n + 1);
    const dy = canvas.height / (state.h + 1);
    ctx.strokeStyle = varColor('--accent'); ctx.lineWidth = 4;
    state.links.forEach((row, y) => {
      const yy = (y + 1) * dy;
      row.forEach(x => {
        ctx.beginPath(); ctx.moveTo(x * dx, yy); ctx.lineTo((x + 1) * dx, yy); ctx.stroke();
      });
    });
  }

  function varColor(name) { return getComputedStyle(document.documentElement).getPropertyValue(name); }

  async function startFrom(colIdx) {
    if(state.links.length === 0 || state.isMoving) return;
    state.isMoving = true;
    const dx = canvas.width / (state.n + 1);
    const dy = canvas.height / (state.h + 1);
    let curX = (colIdx + 1) * dx, curY = 0, curCol = colIdx + 1;

    piece.style.display = 'block';
    updatePiecePos(curX, curY);

    for(let y=0; y<state.h; y++) {
      const targetY = (y + 1) * dy;
      await animatePiece(curX, targetY); curY = targetY;
      let nextX = curX;
      if(state.links[y].includes(curCol)) { nextX = (curCol + 1) * dx; curCol++; }
      else if(state.links[y].includes(curCol - 1)) { nextX = (curCol - 1) * dx; curCol--; }
      if(nextX !== curX) { await animatePiece(nextX, curY); curX = nextX; }
    }
    await animatePiece(curX, canvas.height);
    state.isMoving = false;
  }

  function updatePiecePos(x, y) {
    piece.style.left = x + 'px';
    piece.style.top = y + 'px';
  }

  function animatePiece(tx, ty) {
    return new Promise(resolve => {
      const sx = parseFloat(piece.style.left), sy = parseFloat(piece.style.top);
      const startTime = performance.now();
      function step(now) {
        const p = Math.min((now - startTime) / 150, 1);
        updatePiecePos(sx + (tx - sx) * p, sy + (ty - sy) * p);
        if(p < 1) requestAnimationFrame(step); else resolve();
      }
      requestAnimationFrame(step);
    });
  }

  function rollDices() {
    const v1 = Math.floor(Math.random()*6)+1, v2 = Math.floor(Math.random()*6)+1;
    document.getElementById('d1').innerText = v1;
    document.getElementById('d2').innerText = v2;
  }
</script>
</body>
</html>
