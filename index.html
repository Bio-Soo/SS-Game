<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>í”„ë¦¬ë¯¸ì—„ ê²Œì„ ì„¼í„°</title>
  <style>
    :root { 
      --naver-green: #03c75a; --bg-gray: #0b0f14; --text-white: #e6eef9; 
      --accent: #6ee7ff; --line-default: #3d4b5d;
    }
    body, html { margin:0; padding:0; height:100%; font-family: 'Malgun Gothic', sans-serif; background: var(--bg-gray); color: var(--text-white); overflow: hidden; }

    /* ê³µí†µ ì´ë¯¸ì§€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .img-btn {
      background-size: 100% 100%; background-repeat: no-repeat; background-position: center;
      border: 1px solid rgba(255,255,255,0.2); cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: white; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); transition: 0.2s;
      background-color: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 5px;
    }
    .img-btn:hover { transform: scale(1.03); filter: brightness(1.2); border-color: var(--accent); }

    /* 1. ë©”ì¸ í˜ì´ì§€ */
    #mainPage {
      height: 100vh; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;
      background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&w=1600&q=80');
      background-size: cover; background-position: center;
    }
    .main-selector { display: flex; gap: 40px; }
    .menu-card { width: 220px; height: 300px; background: rgba(255,255,255,0.1); backdrop-filter: blur(15px); border: 2px solid var(--accent); border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
    .menu-card i { font-size: 60px; margin-bottom: 20px; }

    /* 2. ê²Œì„ í˜ì´ì§€ ê³µí†µ */
    #gamePage { display: none; height: 100vh; width: 100%; position: relative; box-sizing: border-box; }
    .top-nav { position: absolute; top: 20px; left: 20px; display: flex; gap: 10px; z-index: 1000; }
    
    /* 3. ì‚¬ë‹¤ë¦¬ ì„¹ì…˜ */
    #ladderGame { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .preset-btns { display: flex; gap: 10px; margin-bottom: 20px; margin-top: 50px; }
    .ladder-board { position: relative; margin-top: 10px; }
    .label-grid { display: flex; width: 700px; justify-content: space-around; }
    .input-box input { width: 60px; padding: 8px 0; background: #1a222d; color: white; border: 1px solid #3d4b5d; border-radius: 6px; text-align: center; }
    #ladderCanvas { background: transparent; cursor: pointer; }
    #playerPiece {
      position: absolute; width: 30px; height: 30px; pointer-events: none; z-index: 100; display: none;
      background: url('https://cdn-icons-png.flaticon.com/128/802/802340.png') no-repeat center/contain;
      transform: translate(-50%, -100%); transition: none;
    }

    /* 4. ì£¼ì‚¬ìœ„ ì„¹ì…˜ - í™”ë©´ ì •ì¤‘ì•™ ë°°ì¹˜ */
    #diceGame { 
      width: 100%; height: 100%; display: none; 
      flex-direction: column; align-items: center; justify-content: center; 
    }
    .dice-row { display: flex; gap: 50px; margin-bottom: 50px; }
    .dice {
      width: 130px; height: 130px; background: white; border-radius: 25px; position: relative;
      box-shadow: 0 15px 35px rgba(0,0,0,0.5);
    }
    .dot { width: 22px; height: 22px; background: #333; border-radius: 50%; position: absolute; transform: translate(-50%, -50%); }
    .roll-btn { width: 260px; height: 75px; font-size: 24px; }
    .rolling { animation: shake 0.1s infinite; }
    @keyframes shake { 0%{transform:rotate(0)} 50%{transform:rotate(5deg)} 100%{transform:rotate(-5deg)} }
  </style>
</head>
<body>

  <div id="mainPage">
    <h1>GAME CENTER</h1>
    <div class="main-selector">
      <div class="menu-card" onclick="showGame('ladder')"><i>ğŸªœ</i><h2>ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</h2></div>
      <div class="menu-card" onclick="showGame('dice')"><i>ğŸ²</i><h2>ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</h2></div>
    </div>
  </div>

  <div id="gamePage">
    <div class="top-nav">
      <button class="img-btn" style="width:100px; height:40px;" onclick="goHome()">BACK</button>
      <button id="navToDice" class="img-btn" style="height:40px; display:none;" onclick="showGame('dice')">ì‚¬ë‹¤ë¦¬ ì—…ê·¸ë ˆì´ë“œ ì£¼ì‚¬ìœ„ ê²Œì„</button>
      <button id="navToLadder" class="img-btn" style="height:40px; display:none;" onclick="showGame('ladder')">ì‚¬ë‹¤ë¦¬íƒ€ê¸°ë¡œ ì´ë™</button>
    </div>
    
    <div id="ladderGame">
      <div class="preset-btns">
        <button class="img-btn" style="width:120px; height:45px;" onclick="applyPreset(5)">ğŸ˜ˆ 835</button>
        <button class="img-btn" style="width:120px; height:45px;" onclick="applyPreset(5)">ğŸ‘¼ 1435</button>
        <button class="img-btn" style="width:120px; height:45px;" onclick="applyPreset(4)">ğŸ‘ 3535</button>
        <button class="img-btn" style="width:120px; height:45px;" onclick="applyPreset(3)">â¤ï¸ 18335</button>
      </div>
      <div class="ladder-board">
        <div id="topInputs" class="label-grid"></div>
        <div style="position: relative;">
          <canvas id="ladderCanvas" width="700" height="400"></canvas>
          <div id="playerPiece"></div>
        </div>
        <div id="bottomInputs" class="label-grid"></div>
      </div>
      <button class="img-btn" onclick="generateLadder()" style="width:200px; height:55px; margin-top:30px; font-size:18px;">ì‚¬ë‹¤ë¦¬ ìƒì„±</button>
    </div>

    <div id="diceGame">
      <div class="dice-row">
        <div id="dice1" class="dice"></div>
        <div id="dice2" class="dice"></div>
      </div>
      <button class="img-btn roll-btn" onclick="rollDices()">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
    </div>
  </div>

<script>
  const canvas = document.getElementById('ladderCanvas');
  const ctx = canvas.getContext('2d');
  const piece = document.getElementById('playerPiece');
  
  // ì„¤ì •ê°’
  let state = { n: 5, h: 12, links: [], isMoving: false, generated: false, activePath: [] };
  const LADDER_BOLD = 4;      // ì‚¬ë‹¤ë¦¬ êµµê¸°
  const MOVE_SPEED = 150;     // ë§ ì´ë™ ì†ë„ (ë‚®ì„ìˆ˜ë¡ ë¹ ë¦„)

  function showGame(type) {
    document.getElementById('mainPage').style.display = 'none';
    document.getElementById('gamePage').style.display = 'block';
    document.getElementById('ladderGame').style.display = type === 'ladder' ? 'flex' : 'none';
    document.getElementById('diceGame').style.display = type === 'dice' ? 'flex' : 'none';
    document.getElementById('navToDice').style.display = type === 'ladder' ? 'block' : 'none';
    document.getElementById('navToLadder').style.display = type === 'dice' ? 'block' : 'none';
    if(type === 'ladder') applyPreset(state.n);
    if(type === 'dice') { drawDice(1, 'dice1'); drawDice(1, 'dice2'); }
  }

  function goHome() { location.reload(); }

  // ì‚¬ë‹¤ë¦¬ ë¡œì§
  function getX(idx) { return (canvas.width / state.n) * idx + (canvas.width / state.n / 2); }

  function applyPreset(count) {
    state.n = count; state.generated = false; state.links = []; state.activePath = [];
    piece.style.display = 'none';
    const tRow = document.getElementById('topInputs'), bRow = document.getElementById('bottomInputs');
    tRow.innerHTML = ''; bRow.innerHTML = '';
    for(let i=0; i<count; i++) {
      tRow.innerHTML += `<div class="input-box"><input type="text" value="${i+1}" onclick="startLadder(${i})"></div>`;
      bRow.innerHTML += `<div class="input-box"><input type="text" value="?"></div>`;
    }
    render();
  }

  function generateLadder() {
    if(state.isMoving) return;
    state.links = Array.from({length: state.h}, () => []);
    for(let y=0; y<state.h; y++) {
      for(let x=0; x<state.n-1; x++) if(Math.random() < 0.5) { state.links[y].push(x); x++; }
    }
    state.generated = true; state.activePath = []; render();
  }

  function render() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.lineCap = 'round';
    
    // ê¸°ë³¸ ì„  ê·¸ë¦¬ê¸°
    ctx.strokeStyle = varColor('--line-default'); ctx.lineWidth = LADDER_BOLD;
    for(let i=0; i<state.n; i++) {
      ctx.beginPath(); ctx.moveTo(getX(i), 0); ctx.lineTo(getX(i), canvas.height); ctx.stroke();
    }
    if(state.generated) {
      const dy = canvas.height / (state.h + 1);
      state.links.forEach((row, y) => {
        row.forEach(x => {
          ctx.beginPath(); ctx.moveTo(getX(x), (y+1)*dy); ctx.lineTo(getX(x+1), (y+1)*dy); ctx.stroke();
        });
      });
    }

    // í•˜ì´ë¼ì´íŠ¸ ê²½ë¡œ ê·¸ë¦¬ê¸°
    if(state.activePath.length > 0) {
      ctx.strokeStyle = varColor('--accent'); ctx.lineWidth = LADDER_BOLD + 2;
      ctx.beginPath();
      ctx.moveTo(state.activePath[0].x, state.activePath[0].y);
      state.activePath.forEach(p => ctx.lineTo(p.x, p.y));
      ctx.stroke();
    }
  }

  function varColor(name) { return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }

  async function startLadder(idx) {
    if(!state.generated || state.isMoving) return;
    state.isMoving = true; state.activePath = [{x: getX(idx), y: 0}];
    const dy = canvas.height / (state.h + 1);
    let curCol = idx, curX = getX(curCol), curY = 0;
    piece.style.display = 'block';
    updatePiece(curX, curY);

    for(let y=0; y<state.h; y++) {
      const targetY = (y+1)*dy;
      await move(curX, targetY); curY = targetY;
      let nextX = curX;
      if(state.links[y].includes(curCol)) { curCol++; nextX = getX(curCol); }
      else if(state.links[y].includes(curCol-1)) { curCol--; nextX = getX(curCol); }
      if(nextX !== curX) { await move(nextX, curY); curX = nextX; }
    }
    await move(curX, canvas.height);
    state.isMoving = false;
  }

  function updatePiece(x, y) { piece.style.left = x + 'px'; piece.style.top = y + 'px'; }

  function move(tx, ty) {
    return new Promise(res => {
      const sx = parseFloat(piece.style.left), sy = parseFloat(piece.style.top);
      const start = performance.now();
      function step(now) {
        const p = Math.min((now - start) / MOVE_SPEED, 1);
        const cx = sx + (tx-sx)*p, cy = sy + (ty-sy)*p;
        updatePiece(cx, cy);
        state.activePath.push({x: cx, y: cy}); render();
        if(p < 1) requestAnimationFrame(step); else res();
      }
      requestAnimationFrame(step);
    });
  }

  // ì£¼ì‚¬ìœ„ ë¡œì§
  function drawDice(num, id) {
    const el = document.getElementById(id); el.innerHTML = '';
    const dots = { 1:[[50,50]], 2:[[25,25],[75,75]], 3:[[25,25],[50,50],[75,75]], 4:[[25,25],[25,75],[75,25],[75,75]], 5:[[25,25],[25,75],[50,50],[75,25],[75,75]], 6:[[25,25],[25,50],[25,75],[75,25],[75,50],[75,75]] };
    dots[num].forEach(p => {
      const d = document.createElement('div'); d.className = 'dot'; d.style.left = p[0]+'%'; d.style.top = p[1]+'%'; el.appendChild(d);
    });
  }
  function rollDices() {
    const d1 = document.getElementById('dice1'), d2 = document.getElementById('dice2');
    d1.classList.add('rolling'); d2.classList.add('rolling');
    setTimeout(() => {
      const v1 = Math.floor(Math.random()*6)+1, v2 = Math.floor(Math.random()*6)+1;
      drawDice(v1, 'dice1'); drawDice(v2, 'dice2');
      d1.classList.remove('rolling'); d2.classList.remove('rolling');
    }, 600);
  }
</script>
</body>
</html>
