<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <title>최종 게임 센터</title>
    <style>
        :root { --accent: #6ee7ff; --bg: #0b0f14; --line: #3d4b5d; }
        body { margin:0; background: var(--bg); color: #fff; font-family: sans-serif; overflow: hidden; }
        
        /* 메인 페이지 */
        #page-main { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .menu-btn { width: 250px; height: 150px; margin: 20px; border: 2px solid var(--accent); border-radius: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 24px; background: rgba(255,255,255,0.1); }

        /* 게임 공통 */
        .game-screen { display: none; height: 100vh; width: 100vw; position: relative; flex-direction: column; align-items: center; justify-content: center; }
        .nav-bar { position: absolute; top: 20px; left: 20px; display: flex; gap: 10px; z-index: 100; }
        .btn { padding: 10px 20px; cursor: pointer; background: #222; border: 1px solid #555; color: #fff; border-radius: 5px; }
        .btn:hover { border-color: var(--accent); }

        /* 사다리 게임 */
        .ladder-area { position: relative; margin-top: 20px; }
        .inputs { display: flex; width: 600px; justify-content: space-around; margin-bottom: 10px; }
        .inputs input { width: 60px; text-align: center; padding: 5px; background: #1a222d; color: #fff; border: 1px solid var(--line); }
        #player { position: absolute; width: 20px; height: 20px; background: #ff4757; border-radius: 50%; display: none; transform: translate(-50%, -100%); z-index: 50; }

        /* 주사위 게임 (중앙 정렬) */
        #dice-game { display: none; text-align: center; }
        .dice-wrap { display: flex; gap: 50px; margin-bottom: 40px; }
        .dice { width: 120px; height: 120px; background: #fff; border-radius: 20px; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .dot { position: absolute; width: 20px; height: 20px; background: #333; border-radius: 50%; transform: translate(-50%, -50%); }
        .roll-btn { padding: 20px 50px; font-size: 20px; background: var(--accent); color: #000; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="page-main">
        <h1>GAME CENTER</h1>
        <div style="display: flex;">
            <div class="menu-btn" onclick="goGame('ladder')">사다리 타기</div>
            <div class="menu-btn" onclick="goGame('dice')">주사위 게임</div>
        </div>
    </div>

    <div id="page-game" class="game-screen">
        <div class="nav-bar">
            <button class="btn" onclick="goHome()">BACK</button>
            <button id="to-dice" class="btn" onclick="goGame('dice')">사다리 업그레이드 주사위 게임</button>
            <button id="to-ladder" class="btn" onclick="goGame('ladder')">사다리타기로 이동</button>
        </div>

        <div id="ladder-game" style="display:none; text-align: center;">
            <div class="inputs" id="top-in"></div>
            <div class="ladder-area">
                <div id="player"></div>
                <canvas id="canvas" width="600" height="400"></canvas>
            </div>
            <div class="inputs" id="bot-in"></div>
            <button class="btn" style="margin-top:20px; width:200px;" onclick="initLadder()">사다리 생성</button>
        </div>

        <div id="dice-game">
            <div class="dice-wrap">
                <div id="dice1" class="dice"></div>
                <div id="dice2" class="dice"></div>
            </div>
            <button class="roll-btn" onclick="rollDice()">주사위 굴리기</button>
        </div>
    </div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const player = document.getElementById('player');
    
    // 사다리 설정 (굵기 조절 가능)
    const L_WIDTH = 4; // 기본 굵기
    const H_WIDTH = 7; // 하이라이트 굵기
    const SPEED = 120; // 속도 (작을수록 빠름)
    
    let state = { n: 5, links: [], isGen: false, isMove: false, path: [] };

    function goHome() { location.reload(); }

    function goGame(type) {
        document.getElementById('page-main').style.display = 'none';
        document.getElementById('page-game').style.display = 'flex';
        document.getElementById('ladder-game').style.display = type === 'ladder' ? 'block' : 'none';
        document.getElementById('dice-game').style.display = type === 'dice' ? 'block' : 'none';
        document.getElementById('to-dice').style.display = type === 'ladder' ? 'block' : 'none';
        document.getElementById('to-ladder').style.display = type === 'dice' ? 'block' : 'none';
        
        if(type === 'ladder') makeInputs(5);
        if(type === 'dice') drawDice(1, 'dice1'), drawDice(1, 'dice2');
    }

    function makeInputs(n) {
        state.n = n; state.isGen = false; state.links = []; state.path = [];
        const top = document.getElementById('top-in'), bot = document.getElementById('bot-in');
        top.innerHTML = ''; bot.innerHTML = '';
        for(let i=0; i<n; i++) {
            top.innerHTML += `<input value="${i+1}" onclick="start(${i})">`;
            bot.innerHTML += `<input value="꽝">`;
        }
        draw();
    }

    function initLadder() {
        state.links = [];
        for(let y=0; y<10; y++) {
            let row = [];
            for(let x=0; x<state.n-1; x++) {
                if(Math.random() > 0.6) { row.push(x); x++; }
            }
            state.links.push(row);
        }
        state.isGen = true; state.path = []; draw();
    }

    function getX(i) { return (canvas.width/state.n) * i + (canvas.width/state.n/2); }

    function draw() {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        ctx.lineCap = 'round';
        
        // 배경 사다리
        ctx.strokeStyle = '#3d4b5d'; ctx.lineWidth = L_WIDTH;
        for(let i=0; i<state.n; i++) {
            ctx.beginPath(); ctx.moveTo(getX(i), 0); ctx.lineTo(getX(i), canvas.height); ctx.stroke();
        }
        if(state.isGen) {
            let dy = canvas.height / 11;
            state.links.forEach((row, y) => {
                row.forEach(x => {
                    ctx.beginPath(); ctx.moveTo(getX(x), (y+1)*dy); ctx.lineTo(getX(x+1), (y+1)*dy); ctx.stroke();
                });
            });
        }

        // 하이라이트
        if(state.path.length > 1) {
            ctx.strokeStyle = '#6ee7ff'; ctx.lineWidth = H_WIDTH;
            ctx.beginPath(); ctx.moveTo(state.path[0].x, state.path[0].y);
            state.path.forEach(p => ctx.lineTo(p.x, p.y));
            ctx.stroke();
        }
    }

    async function start(idx) {
        if(!state.isGen || state.isMove) return;
        state.isMove = true; state.path = [{x: getX(idx), y:0}];
        player.style.display = 'block';
        
        let curX = getX(idx), curY = 0, curCol = idx;
        let dy = canvas.height / 11;

        for(let y=0; y<10; y++) {
            await move(curX, (y+1)*dy); curY = (y+1)*dy;
            let nx = curX;
            if(state.links[y].includes(curCol)) { curCol++; nx = getX(curCol); }
            else if(state.links[y].includes(curCol-1)) { curCol--; nx = getX(curCol); }
            if(nx !== curX) { await move(nx, curY); curX = nx; }
        }
        await move(curX, canvas.height);
        state.isMove = false;
    }

    function move(tx, ty) {
        return new Promise(res => {
            let sx = state.path[state.path.length-1].x, sy = state.path[state.path.length-1].y;
            let startTime = performance.now();
            function step(now) {
                let p = Math.min((now - startTime)/SPEED, 1);
                let cx = sx + (tx-sx)*p, cy = sy + (ty-sy)*p;
                player.style.left = cx + 'px'; player.style.top = cy + 'px';
                state.path.push({x:cx, y:cy}); draw();
                if(p < 1) requestAnimationFrame(step); else res();
            }
            requestAnimationFrame(step);
        });
    }

    // 주사위
    function drawDice(n, id) {
        const el = document.getElementById(id); el.innerHTML = '';
        const dots = { 1:[[50,50]], 2:[[25,25],[75,75]], 3:[[25,25],[50,50],[75,75]], 4:[[25,25],[25,75],[75,25],[75,75]], 5:[[25,25],[25,75],[50,50],[75,25],[75,75]], 6:[[25,25],[25,50],[25,75],[75,25],[75,50],[75,75]] };
        dots[n].forEach(p => {
            let d = document.createElement('div'); d.className = 'dot';
            d.style.left = p[0]+'%'; d.style.top = p[1]+'%'; el.appendChild(d);
        });
    }
    function rollDice() {
        let v1 = Math.floor(Math.random()*6)+1, v2 = Math.floor(Math.random()*6)+1;
        drawDice(v1, 'dice1'); drawDice(v2, 'dice2');
    }
</script>
</body>
</html>
